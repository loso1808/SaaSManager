var settings = require('./config');

var ora = require('../lib/oracle')(settings);

ora.createConnectionPool(settings, function(err, pool) {

  for (var k = 0; k < 5; k++) {
    setTimeout(function() {
      var query = "SELECT * FROM ( SELECT * FROM PRODUCT ";

      for (var i = 0; i < 5; i++) {
        query = query + " UNION ALL SELECT * FROM PRODUCT ";
      }

      query = query + " ) WHERE ROWNUM <= 300";
      pool.getConnection(function(err, conn) {
        if (err) {
          console.error(err);
          process.exit(1);
        }
        console.log(query);
        conn.execute(query, [], function(err, result) {
          if (err) {
            console.error(err);
            process.exit(1);
          } else {
            console.log(result);
            conn.close();
          }
        });
      });
    }, 2000*k);
  }
});
